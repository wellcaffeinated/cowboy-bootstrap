# Nomad Server Configuration
# Generated by Ansible

# Data directory
data_dir = "/opt/nomad"

# Datacenter
datacenter = "boulder"

# Server mode
server {
  enabled = true
  bootstrap_expect = 1
}

# Client mode (bootstrap server acts as both server and client)
client {
  enabled = true
}

# Consul integration
consul {
  address = "127.0.0.1:8500"
  auto_advertise = true
  server_auto_join = true
  client_auto_join = true
}

# Vault integration
vault {
  enabled = true
  address = "http://127.0.0.1:8200"
  create_from_role = "nomad-cluster"
}

# Bind addresses
bind_addr = "0.0.0.0"

# Advertise addresses
advertise {
  http = "{{ ansible_default_ipv4.address }}"
  rpc = "{{ ansible_default_ipv4.address }}"
  serf = "{{ ansible_default_ipv4.address }}"
}

# Enable Docker driver
plugin "docker" {
  config {
    allow_privileged = true
    volumes {
      enabled = true
    }
  }
}

# UI
ui {
  enabled = true
}
